{% from "view/_widgets.html" import widget_js with context %}

<!DOCTYPE html>
  <head>
    <meta charset="utf-8" />
    <title>{% trans %}Embedded Visualisation{% endtrans %} - {{site_title}}</title>
    <link rel="shortcut icon" href="{{ static_path('img/favicon.ico') }}" type="image/x-icon" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    {% assets "css_embed" %}
      <link href="{{ ASSET_URL }}" rel="stylesheet" />
    {% endassets %}

    {% if optional_head %}
      {{optional_head}}
    {% endif %}
  </head>

  <!-- templates/dataset/embed.html body -->
  <body>
    {% if widget %}
      <div id="widget"></div>
    {% endif %}

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="{{ static_path('js/json2.js') }}"></script>
    <script src="{{ static_path('openspendingjs/prod/boot.js') }}"></script>

    <script defer="defer">
		  OpenSpending.scriptRoot = "{{ static_path('openspendingjs') }}";
		  OpenSpending.localeGroupSeparator = "{{ number_symbols_group }}";
		  OpenSpending.localeDecimalSeparator = "{{ number_symbols_decimal }}";
    </script>

    {{widget_js('widget', widget, state, handles=False, embed=True)}}
    
    <a id="credit" target="_blank" href="https://openspending.org/">
      {% trans %}Visualised with OpenSpending{% endtrans %}
    </a>

    {% if not config.DEBUG %}
      <script type="text/javascript" defer="defer">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-8271754-17']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
    {% endif %}
  </body>
</html>



