{% extends "base.html" %}
{% from "_util.html" import angular_templates %}

{% block page_title %}{{ dataset.label }}{% endblock %}
{% block page_desc %}{{ dataset.description | markdown_preview }}{% endblock %}

{% block content %}
  <div ng-controller="DatasetCtrl">
    <h1 class="page-header">
      {{ dataset.label }}
      <div class="pull-right">
        <div class="btn-group" role="group">
          <button type="button" class="btn btn-success">Publish</button>
          <button type="button" ng-click="deleteDataset()" class="btn btn-danger">Delete</button>
        </div>
      </div>
    </h1>
    <div>
      <div class="row">
        <div class="col-md-10">
          {% block inner_content %}{% endblock %}
        </div>
        <div class="col-md-2">
          <ul class="nav nav-pills nav-stacked">
            <li ng-class="{'active': currentSection == 'home'}">
              <a href="{{url_for('dataset.view', dataset=dataset.name)}}">
                Home
              </a>
            </li>
            <li ng-class="{'active': currentSection == 'data'}">
              <a href="{{url_for('dataset.view', dataset=dataset.name)}}/admin/data">
                Source Data
              </a>
            </li>
            <li ng-class="{'active': currentSection == 'model'}">
              <a href="{{url_for('dataset.view', dataset=dataset.name)}}/admin/model">
                Data Model
              </a>
            </li>
            <li ng-class="{'active': currentSection == 'metadata'}">
              <a href="{{url_for('dataset.view', dataset=dataset.name)}}/admin/metadata">
                Settings
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script defer="defer">
    SPENDB_CONFIG.dataset = {{ dataset.to_dict() | tojson }};
  </script>
  {{ angular_templates(templates) }}
{% endblock %}
