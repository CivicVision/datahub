{% extends "base.html" %}

{% block page_title %}{% trans %}Import a dataset{% endtrans %}{% endblock %}

{% block content %}
  <h2 class="page-header">
    {% trans %}Import a dataset{% endtrans %}
  </h2>

  <div ng-controller="DatasetNewCtrl">
    <!-- templates/dataset/new_cta.html content -->
    <div class="row" ng-hide="canCreate">
      <div class="col-md-6">
        {% trans %}We're trying to gather <strong>the world's spending
        information</strong> in a common database so that we can provide
        common tools for <strong>analysis, visualization and
        comparison</strong>. SpenDB is an open platform that
        aims to facilitate the presentation of financial information so 
        anyone - whether data geek or concerned citizen - can contribute 
        their local city budget or spending reports.{% endtrans %}
      </div>
      <div class="col-md-6">
        <p>
          {% trans %}There are many projects that aim to track financial information. All
          require these basic services, which we aim to provide{% endtrans %}:
        </p>
        <ul>
          <li>{% trans %}Data loading and validation facilities.{% endtrans %}</li>
          <li>{% trans %}Common visualization types (treemaps, charts, and the bubble
          tree).{% endtrans %}</li>
          <li>{% trans %}Full-text search for all entries.{% endtrans %}</li>
          <li>{% trans %}Means to track provenance and provide access to the raw
          data.{% endtrans %}</li>
        </ul>
        
      </div>
      <div class="col-md-12">
        <a href="{{url_for('account.login')}}"
          class="btn btn-lg btn-success">{% trans %}Sign up to contribute{% endtrans %}</a>
        <a href="http://community.mapthemoney.org/help/"
          class="btn btn-lg btn-default">{% trans %}Learn more{% endtrans %}</a>
      </div>
    </div>
    
    <!-- templates/dataset/new.html content -->
    <div class="row" ng-show="canCreate">
      <div class="col-md-4">
        <div class="alert alert-info">
          <p>
            {% trans %}If you have a spending or budget dataset that 
            you can contribute, please give some basic information 
            here.{% endtrans %}
          </p>
          <p>
            {% trans %}In the next steps, you'll{% endtrans %}
          </p>
          {% trans %}
          <ul>
            <li>add references to <strong>data sources</strong>,</li>
            <li>create a <strong>data model</strong> to describe the format,</li>
            <li><strong>test</strong> the correctness of your model,</li>
            <li><strong>import</strong> the data,</li>
            <li>and generate <strong>visualized views</strong>.</li>
          </ul>
          {% endtrans %}
        </div>
      </div>
      <div class="col-md-8 dataset-info">
        <form class="form-horizontal" name="form" ng-submit="save(form)">
          <div class="form-group" ng-class="{'has-error': form.label.$invalid}">
            <label for="label" class="col-sm-2 control-label">
              {% trans %}Title{% endtrans %}
            </label>
            <div class="col-sm-10">
              <input name="label" ng-model="dataset.label" class="form-control"
                placeholder="{% trans %}My Dataset{% endtrans %}">
              <p class="help-block" ng-show="form.label.$invalid"
                ng-bind="form.label.$message"></p>
            </div>
          </div>
          <div class="form-group" ng-class="{'has-error': form.name.$invalid}">
            <label for="name" class="col-sm-2 control-label">
              {% trans %}Identifier{% endtrans %}
            </label>
            <div class="col-sm-10">
              <input name="name" ng-model="dataset.name" class="form-control"
                placeholder="{% trans %}my_dataset{% endtrans %}">
              <p class="help-block" ng-show="form.name.$invalid"
                ng-bind="form.name.$message"></p>
              <p class="help-block">
                {% trans %}The identifier will become part of the
                dataset URL and cannot be changed later. It may only 
                contain alphanumeric characters, dashes and underscores.{% endtrans %}
              </p>
            </div>
          </div>
          <div class="form-group" ng-class="{'has-error': form.category.$invalid}">
            <label for="category" class="col-sm-2 control-label">
              {% trans %}Category{% endtrans %}
            </label>
            <div class="col-sm-10">
              <select name="category" chosen class="form-control"
                ng-model="dataset.category" disable-search="true"
                ng-options="c.code as c.label for c in reference.categories">
              </select>
              <p class="help-block" ng-show="form.category.$invalid"
                ng-bind="form.category.$message"></p>
            </div>
          </div>
          <div class="form-group" ng-class="{'has-error': form.currency.$invalid}">
            <label for="currency" class="col-sm-2 control-label">
              {% trans %}Currency{% endtrans %}
            </label>
            <div class="col-sm-10">
              <select name="currency" chosen class="form-control"
                ng-model="dataset.currency"
                ng-options="c.code as c.label for c in reference.currencies">
              </select>
              <p class="help-block" ng-show="form.currency.$invalid"
                ng-bind="form.currency.$message"></p>
            </div>
          </div>
          <div class="form-group" ng-class="{'has-error': form.territories.$invalid}">
            <label for="territories" class="col-sm-2 control-label">
              {% trans %}Countries{% endtrans %}
            </label>
            <div class="col-sm-10">
              <select name="territories" multiple chosen class="form-control"
                ng-model="dataset.territories"
                ng-options="t.code as t.label for t in reference.territories">
              </select>
              <p class="help-block" ng-show="form.territories.$invalid"
                ng-bind="form.territories.$message"></p>
            </div>
          </div>
          <div class="form-group" ng-class="{'has-error': form.languages.$invalid}">
            <label for="languages" class="col-sm-2 control-label">
              {% trans %}Languages{% endtrans %}
            </label>
            <div class="col-sm-10">
              <select name="languages" multiple chosen class="form-control"
                ng-model="dataset.languages"
                ng-options="l.code as l.label for l in reference.languages">
              </select>
              <p class="help-block" ng-show="form.languages.$invalid"
                ng-bind="form.languages.$message"></p>
            </div>
          </div>
          <div class="form-group" ng-class="{'has-error': form.description.$invalid}">
            <label for="description" class="col-sm-2 control-label">
              {% trans %}Description{% endtrans %}
            </label>
            <div class="col-sm-10">
              <p class="help-block" ng-show="form.description.$invalid"
                ng-bind="form.description.$message"></p>
              <textarea ng-model="dataset.description" class="xxlarge form-control"
                rows="4" name="description"></textarea>
            </div>
          </div>
          <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
              <button type="submit" class="btn btn-success">
                {% trans %}Next Step{% endtrans %}
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endblock %}
